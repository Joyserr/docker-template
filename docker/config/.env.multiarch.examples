# ========================================
# 多架构Docker镜像构建配置示例
# ========================================
# 本文件展示不同场景下的配置示例
# 复制需要的配置到 docker/.env.multiarch

# ========================================
# 场景1: 本地开发和测试（默认配置）
# ========================================
# 适用于在本地构建和测试多架构镜像

# 用户配置
USER_NAME=duboping
USER_UID=1000
USER_GID=1000

# Docker镜像基础配置
IMAGE_NAME=ros-kudan-dev
IMAGE_TAG=latest
CONTAINER_NAME=kudan_ws_container

# ROS发行版配置
ROS_DISTRO=noetic

# 工作空间挂载配置
WORKSPACE_DIR=/home/duboping/public/kudan/kudan_ws

# 构建器名称
BUILDER_NAME=multiarch-builder

# 目标平台（本地开发通常选择常用平台）
TARGET_PLATFORMS="linux/amd64 linux/arm64"

# 构建输出类型（保存到本地）
BUILD_OUTPUT_TYPE=local

# 是否使用缓存
BUILD_CACHE=true

# ========================================
# 场景2: 生产环境部署（推送到仓库）
# ========================================
# 适用于构建并推送镜像到Docker Hub或其他仓库

# 用户配置
USER_NAME=duboping
USER_UID=1000
USER_GID=1000

# Docker镜像基础配置
IMAGE_NAME=ros-kudan-dev
IMAGE_TAG=1.0.0
CONTAINER_NAME=kudan_ws_container

# ROS发行版配置
ROS_DISTRO=noetic

# 工作空间挂载配置
WORKSPACE_DIR=/home/duboping/public/kudan/kudan_ws

# 构建器名称
BUILDER_NAME=multiarch-builder

# 目标平台（生产环境通常需要所有平台）
TARGET_PLATFORMS="linux/amd64 linux/arm64 linux/arm/v7"

# 构建输出类型（推送到仓库）
BUILD_OUTPUT_TYPE=registry

# 镜像仓库配置
REGISTRY=docker.io
REPO_NAME=yourusername/ros-kudan-dev

# 是否使用缓存
BUILD_CACHE=true

# 是否推送镜像到仓库
PUSH_IMAGES=true

# ========================================
# 场景3: 仅构建AMD64镜像（快速测试）
# ========================================
# 适用于快速开发和测试，只构建当前架构

# 用户配置
USER_NAME=duboping
USER_UID=1000
USER_GID=1000

# Docker镜像基础配置
IMAGE_NAME=ros-kudan-dev
IMAGE_TAG=dev
CONTAINER_NAME=kudan_ws_container

# ROS发行版配置
ROS_DISTRO=noetic

# 工作空间挂载配置
WORKSPACE_DIR=/home/duboping/public/kudan/kudan_ws

# 构建器名称
BUILDER_NAME=multiarch-builder

# 目标平台（仅AMD64）
TARGET_PLATFORMS="linux/amd64"

# 构建输出类型
BUILD_OUTPUT_TYPE=docker

# 是否使用缓存
BUILD_CACHE=true

# ========================================
# 场景4: 离线部署（导出为tar文件）
# ========================================
# 适用于需要离线部署的场景

# 用户配置
USER_NAME=duboping
USER_UID=1000
USER_GID=1000

# Docker镜像基础配置
IMAGE_NAME=ros-kudan-dev
IMAGE_TAG=offline
CONTAINER_NAME=kudan_ws_container

# ROS发行版配置
ROS_DISTRO=noetic

# 工作空间挂载配置
WORKSPACE_DIR=/home/duboping/public/kudan/kudan_ws

# 构建器名称
BUILDER_NAME=multiarch-builder

# 目标平台
TARGET_PLATFORMS="linux/amd64 linux/arm64"

# 构建输出类型（导出为tar）
BUILD_OUTPUT_TYPE=tar

# 输出文件路径
OUTPUT_PATH=./output/images

# 是否使用缓存
BUILD_CACHE=false

# ========================================
# 场景5: ARM嵌入式设备（仅ARM架构）
# ========================================
# 适用于ARM嵌入式设备，如树莓派、Jetson等

# 用户配置
USER_NAME=duboping
USER_UID=1000
USER_GID=1000

# Docker镜像基础配置
IMAGE_NAME=ros-kudan-dev
IMAGE_TAG=arm
CONTAINER_NAME=kudan_ws_container

# ROS发行版配置
ROS_DISTRO=noetic

# 工作空间挂载配置
WORKSPACE_DIR=/home/duboping/public/kudan/kudan_ws

# 构建器名称
BUILDER_NAME=multiarch-builder

# 目标平台（仅ARM架构）
TARGET_PLATFORMS="linux/arm64 linux/arm/v7"

# 构建输出类型
BUILD_OUTPUT_TYPE=local

# 是否使用缓存
BUILD_CACHE=true

# ========================================
# 场景6: CI/CD自动化构建
# ========================================
# 适用于CI/CD流水线，自动化构建和推送

# 用户配置
USER_NAME=duboping
USER_UID=1000
USER_GID=1000

# Docker镜像基础配置
IMAGE_NAME=ros-kudan-dev
IMAGE_TAG=${CI_COMMIT_TAG:-latest}
CONTAINER_NAME=kudan_ws_container

# ROS发行版配置
ROS_DISTRO=noetic

# 工作空间挂载配置
WORKSPACE_DIR=/home/duboping/public/kudan/kudan_ws

# 构建器名称
BUILDER_NAME=multiarch-builder

# 目标平台
TARGET_PLATFORMS="linux/amd64 linux/arm64"

# 构建输出类型
BUILD_OUTPUT_TYPE=registry

# 镜像仓库配置
REGISTRY=docker.io
REPO_NAME=yourusername/ros-kudan-dev

# 是否使用缓存
BUILD_CACHE=true

# 构建并发数
BUILD_JOBS=4

# 是否推送镜像到仓库
PUSH_IMAGES=true

# 是否创建manifest列表
CREATE_MANIFEST=true

# ========================================
# 场景7: 私有镜像仓库
# ========================================
# 适用于使用私有镜像仓库的场景

# 用户配置
USER_NAME=duboping
USER_UID=1000
USER_GID=1000

# Docker镜像基础配置
IMAGE_NAME=ros-kudan-dev
IMAGE_TAG=latest
CONTAINER_NAME=kudan_ws_container

# ROS发行版配置
ROS_DISTRO=noetic

# 工作空间挂载配置
WORKSPACE_DIR=/home/duboping/public/kudan/kudan_ws

# 构建器名称
BUILDER_NAME=multiarch-builder

# 目标平台
TARGET_PLATFORMS="linux/amd64 linux/arm64"

# 构建输出类型
BUILD_OUTPUT_TYPE=registry

# 私有镜像仓库配置
REGISTRY=registry.example.com
REPO_NAME=myorg/ros-kudan-dev

# 是否使用缓存
BUILD_CACHE=true

# 是否推送镜像到仓库
PUSH_IMAGES=true

# ========================================
# 场景8: 完整平台支持（所有架构）
# ========================================
# 适用于需要支持所有平台的场景

# 用户配置
USER_NAME=duboping
USER_UID=1000
USER_GID=1000

# Docker镜像基础配置
IMAGE_NAME=ros-kudan-dev
IMAGE_TAG=full
CONTAINER_NAME=kudan_ws_container

# ROS发行版配置
ROS_DISTRO=noetic

# 工作空间挂载配置
WORKSPACE_DIR=/home/duboping/public/kudan/kudan_ws

# 构建器名称
BUILDER_NAME=multiarch-builder

# 目标平台（所有支持的平台）
TARGET_PLATFORMS="linux/amd64 linux/arm64 linux/arm/v7 linux/riscv64"

# 构建输出类型
BUILD_OUTPUT_TYPE=registry

# 镜像仓库配置
REGISTRY=docker.io
REPO_NAME=yourusername/ros-kudan-dev

# 是否使用缓存
BUILD_CACHE=true

# 构建并发数
BUILD_JOBS=4

# 构建超时时间（秒）
BUILD_TIMEOUT=7200

# 是否推送镜像到仓库
PUSH_IMAGES=true

# 是否创建manifest列表
CREATE_MANIFEST=true

# ========================================
# 使用说明
# ========================================
# 1. 根据您的使用场景，选择相应的配置
# 2. 复制选中的配置到 docker/.env.multiarch 文件
# 3. 根据需要修改配置参数
# 4. 运行构建命令：
#    - make build-multiarch
#    - 或 ./docker/scripts/build/docker-build-multiarch.sh
# 5. 验证构建结果：
#    - docker images | grep ros-kudan-dev
#    - docker buildx imagetools inspect ros-kudan-dev:latest